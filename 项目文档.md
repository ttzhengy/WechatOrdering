# 项目文档

## 项目简介和需求

### 名称

中小企业微信点餐系统

### 产品介绍

消费者使用移动端的微信小程序可以进行浏览商品、操作订单等操作。商家可以通过登录后台业务管理系统，管理商品的类目和具体信息，处理消费者订单等。

### 技术要求

- SpringBoot
- MyBatis
- MySQL
- Redis

## 项目细节

### 项目结构

### 数据库结构

1. 商品类目表：与商品信息表是一对多关系
   - 类目id：主键
   - 类目名称
   - 类目种类
2. 商品信息表：与订单细节表是一对多关系
   - 商品id：主键
   - 商品名称
   - 商品单价
   - 商品库存
   - 商品描述
   - 商品图片（url）
   - 商品状态：0上架，1下架。默认0
   - 商品类目：外键—category_id—》商品类目表
3. 订单主表：与订单细节表是一对多关系
   - 订单id：主键
   - 买家名称
   - 买家电话
   - 买家地址
   - 买家openid
   - 订单总额
   - 订单状态：0新下单，1已完成，2取消订单。默认0
   - 支付状态：0未支付，1已支付。默认0
4. 订单细节表
   - 细节表id：主键
   - 订单主表id：外键—order_id—》订单主表
   - 商品id：外键—product_id—》商品信息表
   - 商品名称
   - 商品价格
   - 商品数量
   - 商品图片
5. 商家登录信息表

### 数据持久（Dao）层

#### 商品类目

ProductCategoryDao接口

- 根据id查询单个商品类目：ProductCategory selectById(int id)
- 根据商品类目编号集合，查询包含的商品类目：List\<ProductCategory> selectByType(List\<Integer> types)
- 插入新商品类目，主键自增并自动获取：void insertProductCategory(ProductCategory productCategory)
- 根据id修改某个商品类目：void updateProductCategory(ProductCategory productCategory)

#### 商品信息

ProductInfoDao接口

- 根据id查询单个商品：ProductInfo selectById(String id)
- 根据商品类目，查询包含的商品：List\<ProductInfo> selectByCategoryType(Integer type)
- 根据商品状态，查询包含的商品：List\<ProductInfo> selectByProductStatus(Integer status)
- 增加商品：boolean insertProductInfo(ProductInfo productInfo)
- 根据id修改某个商品：boolean updateProductInfo(ProductInfo productInfo)

#### 订单主表

OrderMasterDao接口，需要pageHelper插件分页

- 根据id查询订单主表：OrderMaster selectById(String id);
- 根据买家openid查询该买家的订单：List\<OrderMaster> selectByBuyerOpenId(String buyerOpenId);
- 增加订单：boolean insertOrderMaster(OrderMaster orderMaster);
- 根据id修改某个订单：boolean updateOrderMaster(OrderMaster orderMaster);

#### 订单细节表

OrderDetailDao接口

- 根据id查询订单细节表：OrderDetail selectById(String id);
- 根据订单主表id，查询该主表下的订单细节表：List\<OrderDetail> selectByOrderId(String orderId);
- 根据商品id，查询包含该商品的订单细节表：List\<OrderDetail> selectByProductId(String productId);
- 增加订单细节：boolean insertOrderDetail(OrderDetail orderDetail);
- 根据id修改订单细节：boolean updateOrderDetail(OrderDetail orderDetail);

### 业务逻辑（Service）

#### 商品类目

##### 接口

CategoryService

- findOne
- findAll
- fingByCategoryType
- insert
- update

##### 实现类

CategoryServiceImpl

### Controller层